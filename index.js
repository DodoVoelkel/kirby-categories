(function(){"use strict";var f=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("k-field",t._b({staticClass:"k-categories-field"},"k-field",t.$props,!1),[e("template",{slot:"options"},[t.canAdd?e("k-button",{attrs:{id:t._uid,icon:"add"},on:{click:t.addCategory}},[t._v(" "+t._s(t.$t("add"))+" ")]):t._e()],1),t.isEmpty?e("k-empty",{attrs:{icon:"tag"},on:{click:t.addCategory}},[t._v(" "+t._s(t.empty)+" ")]):e("div",{staticClass:"k-categories-table"},[e("div",{staticClass:"k-categories-header"},[t._l(t.sortedLanguages,function(i){return e("div",{key:i.code,class:[{disabled:!t.isCurrent(i)},"language"],on:{click:function(l){return t.changeLanguage(i)}}},[t._v(" "+t._s(i.name)+" ")])}),e("div",{staticClass:"delete-placeholder"})],2),e("k-draggable",{staticClass:"k-categories-list",attrs:{list:t.localValue,handle:!0,element:"ul"},on:{end:t.onInput}},t._l(t.localValue,function(i,l){return e("li",{staticClass:"k-categories-item"},[e("k-sort-handle"),t._l(t.sortedLanguages,function(r,u){return e("div",{key:r.code,class:["language",{"has-input":t.isCurrent(r)}]},[t.isCurrent(r)?e("k-input",{ref:i.id,refInFor:!0,attrs:{type:"text",id:i.id,theme:"field",value:i.text},on:{input:function(c){return t.onTextInput(l,c)}}}):e("div",{staticClass:"disabled"},[t._v(t._s(i.translations[r.code]))])],1)}),e("k-button",{attrs:{icon:"trash"},on:{click:function(r){return t.removeCategory(i.id)}}})],2)}),0)],1)],2)},_=[],y="";function p(t,n,e,i,l,r,u,c){var a=typeof t=="function"?t.options:t;n&&(a.render=n,a.staticRenderFns=e,a._compiled=!0),i&&(a.functional=!0),r&&(a._scopeId="data-v-"+r);var o;if(u?(o=function(s){s=s||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!s&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(s=__VUE_SSR_CONTEXT__),l&&l.call(this,s),s&&s._registeredComponents&&s._registeredComponents.add(u)},a._ssrRegister=o):l&&(o=c?function(){l.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:l),o)if(a.functional){a._injectStyles=o;var $=a.render;a.render=function(k,g){return o.call(g),$(k,g)}}else{var h=a.beforeCreate;a.beforeCreate=h?[].concat(h,o):[o]}return{exports:t,options:a}}const v={props:{default:[String,Boolean],defaultFirst:Boolean,limit:Number,prefix:String,label:String,disabled:Boolean,help:String,parent:String,empty:String,value:[Array],name:[String,Number],required:Boolean,type:String},data(){return{localValue:this.value}},watch:{value:function(t){this.localValue!==t&&(this.localValue=t)}},computed:{languages(){return this.$store.state.languages?this.$store.state.languages.all:this.$languages},sortedLanguages(){if(!this.defaultFirst)return this.languages;let t=this.languages.find(e=>e.default==!0),n=this.languages.filter(e=>e.default!==!0);return n.unshift(t),n},currentLanguage(){return this.$store.state.languages?this.$store.state.languages.current:this.$language},currentCode(){return this.currentLanguage.code},exists(){return this.localValue&&this.localValue.length},isEmpty(){return!this.exists||!this.localValue.length},canAdd(){return!this.limit||!this.localValue||!this.localValue.length||this.localValue.length<this.limit},newIndex(){return!this.localValue||!this.localValue.length?1:this.localValue.length+1}},methods:{isCurrent(t){return t.code==this.currentCode},addCategory(){let t=this.prefix+this.newIndex,n={id:t,panelIndex:this.newIndex,text:"",translations:{}};this.languages.forEach(e=>{n.translations[e.code]=""}),this.exists?this.localValue=[n].concat(this.localValue):this.localValue=[n],this.onInput(),this.$nextTick(()=>{let e=this.$refs[t];e&&e[0].focus()})},removeCategory(t){this.localValue=this.localValue.filter(n=>n.id!==t),this.onInput()},onTextInput(t=!1,n){this.localValue[t].text=n,this.localValue[t].translations[this.currentCode]=n,this.onInput()},onInput(){this.$emit("input",this.localValue)},changeLanguage(t){this.$emit("change",t),this.$go(this.$view.path,{query:{language:t.code}})}}},d={};var C=p(v,f,_,!1,m,null,null,null);function m(t){for(let n in d)this[n]=d[n]}var V=function(){return C.exports}();panel.plugin("sylvainjule/categories",{fields:{categories:V}})})();
